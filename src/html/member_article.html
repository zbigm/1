<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>AAECA</title>
    <link rel="stylesheet" href="./public/Styles/css/vendor.min.css">
    <link rel="stylesheet" href="./public/Styles/main.css">
    <script src="./public/Scripts/main.js"></script>
    <script src="./public/Scripts/vendor.min.js"></script>
</head>
<body>
<div class="container-fluid">
	<!--member-header-->
	<div class="wrap-member-header">
		<a href="member.html" class="backarrow" style="visibility: hidden;">
			<img src="./public/Images/backarrow.png"/>
		</a>
		<div class="wrap-user-icon">
            <a href="member_information.html">
			    <img src="./public/Images/memberico.png"/>
            </a>
		</div>
		<h3 class="text-center">Bowman</h3>
		<h4 class="text-center">Mobile Internet</h4>
	</div><!--wrap-member-header-->
	<div class="row wrap-member-title">
        <ul class="clearfix">
            <li class=" col-xs-4 contentType" data-type="Article">
                <a href="javascript:void(0);" >
                    <span>0</span>
                    <i>Article</i>
                </a>
            </li>
            <li class="col-xs-4 contentType"  data-type="Project">
                <a href="javascript:void(0);" >
                    <span>0</span>
                    <i>Project</i>
                </a>
            </li>
            <li class="col-xs-4 contentType" data-type="Video">
                <a href="javascript:void(0);" >
                    <span>0</span>
                    <i>Video</i>
                </a>
            </li>
        </ul>
    </div><!-- wrap-navbar -->
    <!--member-header-->
    <div class="wrap-news-item">
        <ul>
            <!-- articleItemTmpl -->
            <li class="news-item articleItemTmpl clearfix" style="display: none">
                <a href="news_detail.html" class="pull-left newsitem-img">
                    <img class="articleImg" src="http://sdf.img" alt="">
                </a>
                <div class="news-item-detail pull-right">
                    <h3><a href="news_detail.html?articleId=1" class="articleTitle">标题标题</a></h3>
                    <p class="news-item-tag"><span class="articleTags">高科技</span></p>
                    <div class="wrap-tagsnew clearfix">
                        <div class="pull-left clearfix">
                            <img src="http://bs.img" alt="" class="pull-left icon-person avatarKey">
                            <span class="pull-left color-grey articleAuthor">作者</span>
                        </div>
                        <div class="pull-right"><span class="color-grey articleDate">8/17/2015</span>
                        </div>
                    </div>
                </div>
            </li>

            <!-- videoItemTmpl -->
            <li class="news-video-item clearfix videoItemTmpl" style="display:none;">
                <div class="video-item-detail">
                    <div class="wrap-news-video">
                        <a class="wrap-video-introduction" href="person_video_detail.html">
                            <img src="./public/Images/newsvideo.png" alt="" class="pull-left newsvedio">
                            <img src="./public/Images/broadcast.png" alt="" class="broadcast-btn">
                            <h4 class="video-title">Project and talent of the benign int eraction of suc
                                cessf Project and talent of the benign int </h4>
                            <span class="bggrey"></span>
                        </a>
                    </div>
                    <div class="news-video-tag clearfix">
                        <div class="pull-left clearfix">
                            <img src="./public/Images/newspeople.png" alt="" class="pull-left icon-person">
                            <span class="pull-left color-grey namemember">Bo Hong</span>
                        </div>
                        <div class="pull-right">
                            <span class="color-grey datamember">August 17, 2017</span>
                        </div>
                    </div>
                </div>
            </li><!-- news-video-item -->

            <li class="news-item projectItemTmpl clearfix" style="display: none">
                <a href="news_detail.html" class="pull-left newsitem-img">
                    <img class="articleImg" src="http://sdf.img" alt="">
                </a>
                <div class="news-item-detail pull-right">
                    <h3><a href="news_detail.html?articleId=1" class="articleTitle">标题标题</a></h3>
                    <p class="news-item-tag"><span class="articleTags">高科技</span></p>
                    <div class="wrap-tagsnew clearfix">
                        <div class="pull-left clearfix">
                            <img src="http://bs.img" alt="" class="pull-left icon-person avatarKey">
                            <span class="pull-left color-grey articleAuthor">作者</span>
                        </div>
                        <div class="pull-right"><span class="color-grey articleDate">8/17/2015</span>
                        </div>
                    </div>
                </div>
            </li>

        </ul>
    </div><!-- wrap-news-item -->

    <div style="padding: 0 0 15px 0;">
        <div class="noMore" style="text-align: center;cursor: pointer;display: none;">没有更多数据</div>
        <div class="loadMore" style="text-align: center;cursor: pointer;display: none;">点击加载更多</div>
        <div class="onRequesting" style="text-align: center;display: none;">正在请求数据...</div>
    </div>
</div><!-- container-fluid -->
<!--{{footer.html}}-->
<script>
    $(function () {

        // 数据加载

        var page = 1
        var type = 'Article'
        var memberId = getSearchParam('memberId') || ''

        $('.contentType').click(function () {
            if($(".onRequesting:visible").length){
                console.log('onrequesting,return')
                return
            }
            $('.contentType').removeClass('active')
            $(this).addClass('active')


            $('.wrap-news-item>ul>li:gt(2)').remove()

            type = $(this).data('type')
            page = 1


            reqData()
        })

        function reqData() {
            $('.onRequesting').show()
            $('.noMore').hide()
            $('.loadMore').hide()
            $get('/' + type + '/Search',{
                p: page++,
                memberId: memberId,
                isRecommend: true
            },function (data) {
                $('.onRequesting').hide()

                if(data.Status == 2){
                    var ret = data.Body
                    if(ret && ret.length){
                        $('.loadMore').show()
                        $('.noMore').hide()

                        makeDt(ret)
                    }else{
                        $('.loadMore').hide()
                        $('.noMore').show()
                    }
                }else{
                    $('.loadMore').show()
                    $('.noMore').hide()
                    alert(data.Message)
                }
            },function () {
                $('.onRequesting').hide()
            })
        }

        function makeDt(data) {
            var $items = []
            if (type == 'Article') {
                for (var i = 0; i < data.length; i++) {
                    var item = data[i]
                    $items.push(makeArticleItem(item))
                }
                $('.wrap-news-item>ul').append($items)
            }else if (type == 'Video') {
                for (var i = 0; i < data.length; i++) {
                    var item = data[i]
                    $items.push(makeVideoItem(item))
                }
                $('.wrap-news-item>ul').append($items)
            }else if (type == 'Member') {
                for (var i = 0; i < data.length; i++) {
                    var item = data[i]
                    $items.push(makeProjectItem(item))
                }
                $('.wrap-news-item>ul').append($items)
            }
        }

        $('.contentType').first().click()
        $('.loadMore').click(reqData)



    })


    function makeArticleItem(dt) {
        var $item = $('.articleItemTmpl').clone().removeClass('articleItemTmpl').css('display', 'block')
        $item.find('.articleTitle').text(dt.Title)
        $item.find('.articleTitle').attr('href','news_detail.html?articleId='+dt.ArticleId)
        $item.find('.newsitem-img').attr('href','news_detail.html?articleId='+dt.ArticleId)
        $item.find('.articleDate').text(fmtDate1(dt.Timestamp))
        $item.find('.articleTags').text(dt.Keywords)
        $item.find('.articleAuthor').text(dt.Member.Name)
        $item.find('.articleImg').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.ImageKey)
        $item.find('.avatarKey').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.Member.AvatarKey)
        return $item
    }

    function makeProjectItem(dt) {
        var $item = $('.articleItemTmpl').clone().removeClass('articleItemTmpl').css('display', 'block')
        $item.find('.articleTitle').text(dt.Title)
        $item.find('.articleTitle').attr('href','news_detail.html?articleId='+dt.ArticleId)
        $item.find('.newsitem-img').attr('href','news_detail.html?articleId='+dt.ArticleId)
        $item.find('.articleDate').text(fmtDate1(dt.Timestamp))
        $item.find('.articleTags').text(dt.Keywords)
        $item.find('.articleAuthor').text(dt.Member.Name)
        $item.find('.articleImg').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.ImageKey)
        $item.find('.avatarKey').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.Member.AvatarKey)
        return $item
    }

    function makeVideoItem(dt) {
        var $item = $('.articleItemTmpl').clone().removeClass('articleItemTmpl').css('display', 'block');
        $item.find('.video-title').text(dt.Title);    //video title
        $item.find('.namemember').text(dt.Member.Name);  //namemember
        $item.find('.datamember').text(fmtDate1(dt.Timestamp));   //date
        $item.find('.icon-person').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.Member.AvatarKey);   //小头像
        $item.find('.newsvedio').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.ImageKey)   // 视频地址
        $item.find('.wrap-video-introduction').attr('href', "person_video_detail.html?VideoId="+dt.VideoId);
        return $item
    }


</script>
</body>
</html>