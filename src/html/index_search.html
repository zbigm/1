<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>AAECA</title>
    <link rel="stylesheet" href="./public/Styles/css/vendor.min.css">
    <link rel="stylesheet" href="./public/Styles/main.css">
    <script src="./public/Scripts/main.js"></script>
    <script src="./public/Scripts/vendor.min.js"></script>
</head>
<body>
<div class="container-fluid index-search">
    <div class="wrap-search-title">
        <div class="wrap-search-header clearfix">
            <div class="wrap-select-box pull-left">
                <div class="input-group">
                    <div class="input-group-btn">
                        <button type="button" class="btn dropdown-toggle clearfix" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="pull-left search-text">Article</i>
                            <span class="caret select-caret pull-left">
                                <img src="./public/Images/selectico.png" alt="">
                            </span>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a href="#">Article</a></li>
                            <li><a href="#">Video</a></li>
                            <li><a href="#">Member</a></li>
                        </ul>
                  </div><!-- /btn-group -->
                </div><!-- /input-group -->
            </div>
            <div class="wrap-search-text pull-right clearfix">
                <span class="input-group-icon pull-left">
                    <img src="./public/Images/lightsearch.png" alt="">
                </span>
                <input type="text" class="input-group-control pull-left searchInput" placeholder="Please enter the content">
            </div>
        </div><!-- wrap-search-header -->
        <div class="wrap-search-type">
            <div class="search-type">Article Type</div>
            <div class="wrap-member-type-box">
                <div class="wrap-search-type container  member-type swiper-container">
                    <ul class="wrap-searchtag clearfix swiper-wrapper searchTags" style="min-height: 45px;">
                        <!--<a href="javascript:void(0);" class="swiper-slide tagbtn pull-left active">&nbsp;</a>-->
                        <!--<a href="javascript:void(0);" class="swiper-slide tagbtn pull-left active">Insight</a>-->
                    </ul>
                </div><!-- wrap-search-type -->
            </div><!-- wrap-member-type-box -->
        </div><!-- wrap-search-type -->
    </div><!-- wrap-search-title -->
    <div class="container noMore" style="display: none">
        <div class="row">
            <div class="col-xs-12 wrap-no-result">
                <div class="text-center">
                    <img src="./public/Images/nosearch.png" alt="">
                </div>
                <div class="no-result-text text-center">
                    <p>No relevant search results, </p>
                    <p>please check other</p>
                </div>
                <div class="wrap-no-result-btn clearfix">
                    <!--<a class="pull-left tagbtn" href="javascript:void(0);">articletag</a>-->
                    <!--<a class="pull-right tagbtn" href="javascript:void(0);">错负责</a>-->
                </div>
            </div>
        </div>
    </div><!-- container -->

    <div class="result-list">

    </div>

    <div class="wrap-news-item articleWrap">
        <ul>
            <!--<li class="news-item articleItemTmpl clearfix" style="display: none">-->
                <!--<a href="news_detail.html" class="pull-left newsitem-img">-->
                    <!--<img class="articleImg" src=" " alt="">-->
                <!--</a>-->
                <!--<div class="news-item-detail pull-right">-->
                    <!--<h3><a href="news_detail.html?articleId=1" class="articleTitle">标题标题</a></h3>-->
                    <!--<p class="news-item-tag"><span class="articleTags">高科技</span></p>-->
                    <!--<div class="wrap-tagsnew clearfix">-->
                        <!--<div class="pull-left clearfix">-->
                            <!--<img src=" " alt="" class="pull-left icon-person avatarKey">-->
                            <!--<span class="pull-left color-grey articleAuthor">作者</span>-->
                        <!--</div>-->
                        <!--<div class="pull-right"><span class="color-grey articleDate">8/17/2015</span>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</li>-->


        </ul>
    </div><!-- wrap-news-item -->


    <div class="wrap-member-list container memberWrap" style="padding: 0 15px;">
        <ul class="clearfix">
            <li class="pull-left col-xs-6 member-list-item memberItemTmpl" style="display: none">
                <!--<a class="person-item clearfix" href="member_article.html">-->
                    <!--<div class="pull-left member-trait">-->
                        <!--<img class="avatarImg" src="" alt="">-->
                    <!--</div>-->
                    <!--<div class="person-item-text pull-left">-->
                        <!--<span class="memberName"></span>-->
                        <!--<i class="memberTags"></i>-->
                    <!--</div>-->
                <!--</a>-->
            </li>

        </ul>
    </div><!-- wrap-member-list -->

    <div class="wrap-news-item videoWrap">
        <ul>
            <li class="news-video-item clearfix videoItemTmpl" style="display:none;">
                <div class="video-item-detail">
                    <div class="wrap-news-video">
                        <a class="wrap-video-introduction" href="person_video_detail.html">
                            <img src="./public/Images/newsvideo.png" alt="" class="pull-left newsvedio">
                            <img src="./public/Images/broadcast.png" alt="" class="broadcast-btn">
                            <h4 class="video-title">Project and talent of the benign int eraction of suc
                                cessf Project and talent of the benign int </h4>
                            <span class="bggrey"></span>
                        </a>
                    </div>
                    <div class="news-video-tag clearfix">
                        <div class="pull-left clearfix">
                            <img src="./public/Images/newspeople.png" alt="" class="pull-left icon-person">
                            <span class="pull-left color-grey namemember"></span>
                        </div>
                        <div class="pull-right">
                            <span class="color-grey datamember"></span>
                        </div>
                    </div>
                </div>
            </li><!-- news-video-item -->


        </ul>
    </div><!-- wrap-news-item -->


    <div style="padding: 0 0 15px 0;">
        <div class="loadMore" style="text-align: center;cursor: pointer;display: none;">点击加载更多</div>
        <div class="onRequesting" style="text-align: center;display: none;">正在请求数据...</div>
    </div>




</div><!-- container-fluid -->
<script>
    $(function () {
        // swiper 滑动导航
//        var navBarSwiper = new Swiper ('.wrap-member-type-box .swiper-container', {
//            slidesPerView: "auto"
//        });
//        $(".wrap-navbar li").click(function(){
//            $(this).addClass('active').siblings().removeClass('active');
//        });
        // swiper 滑动导航
        $('.dropdown-toggle').dropdown()
        $(".dropdown-menu li").click(function(){
            var text = $(this).find("a").text()
            $('.search-type').text(text + ' Type')
            $(".btn .search-text").text(text)
            if(text == 'Article'){
                setTags(articleTags)
            }else if(text == 'Video'){
                setTags(videoTags)
            }else if(text == 'Member'){
                setTags(memberTags)

            }
        })

        $('.searchTags').on('click', '>a', function () {
            if($('.onRequesting:visible').length){
                return
            }

            var keyword = $('.searchInput').val().trim()
            var type = $(".btn .search-text").text()
            var tag = $(this).text()

            $(this).siblings().removeClass('active')
            $(this).addClass('active')
//            alert(type + ' ' + tag + ' ' + $(this).data('tid') + ' ' + keyword)

            doSearch()
        })

        function setTags(tagsObj) {
            var tgs = []

            var tags = []
            for(var k in tagsObj){
                tags.push([tagsObj[k], k])
            }

            for(var i=0; i<tags.length; i++){
                var $tg = $('<a href="javascript:void(0);"></a>')
                    .addClass('swiper-slide tagbtn ' + ' tagBtn'+i)
                    .css({display: 'inline-block',width: 'atuo'})
                    .text(tags[i][0]).data('tid',tags[i][1])
//                var $taWrap = $('<div></div>').css({'width': '25%',textAlign: 'center'}).append($tg)
                tgs.push($tg)
            }
            $('.searchTags').empty().append(tgs)
        }

        var articleTags = {
            1: 'Insight',
            2: 'TopNews',
            3: 'TechExpress',
            4: 'Project'
        }
        var videoTags = {
            1: 'Insight',
            2: 'TopNews',
            3: 'TechExpress',
            4: 'Project'
        }
        var memberTags = {
            1: 'Big Data',
            2: 'AI',
            3: 'Mobile Internet',
            4: 'Cloud Tech'
        }

        $('.searchInput').keydown(function(e) {
            if (e.keyCode == 13) {
                doSearch()
            }
        })


        function doSearch() {
            var page = 1;

            $('.result-list').empty()

            $('.loadMore').off()
            $('.noMore').hide()
            $('.loadMore').hide()
            $('.onRequesting').show()


            var keyword = $('.searchInput').val().trim()
            var type = $(".btn .search-text").text()
            var tag = $('.searchTags>a.active').text()
            var $fn = $get

            var url = '/' + (type == 'Member' ? 'Account' : type) + '/Search'
            var dt = {
                keyword: keyword,
                p: page++
            }
            if (type == 'Article') {
                dt.articleType = tag
            } else if (type == 'Video') {
                dt.videoType = tag
            } else if (type == 'Member') {
                $fn = $post
            }

            $('.loadMore').click(function () {
                $('.onRequesting').show()
                $(this).hide()
                dt.p = page++
                reqData($fn, url, type, dt)
            })

            reqData($fn,url, type, dt)

            //
        }


        function reqData($fn,url, type, dt) {
            $fn(url,{
                dt
            },function (data) {
                $('.onRequesting').hide()
                if(data.Status == 2){
                    var ret = data.Body
                    if(ret && ret.length){
                        $('.loadMore').show()
                        $('.noMore').hide()

                        makeDt(type, ret)

                        $('.result-list .memberItem:even').css({float: 'left', marginLeft: '0.21px'})
                        $('.result-list .memberItem:odd').css({float: 'right'})

                    }else{
                        $('.loadMore').hide()
                        $('.noMore').show()
                    }
                }else{
                    $('.loadMore').show()
                    $('.noMore').hide()
                    alert(data.Message)
                }
            },function () {
                $('.onRequesting').hide()
            })
        }

        function makeDt(type, data) {
            var $items = []
            if (type == 'Article') {
                for (var i = 0; i < data.length; i++) {
                    var item = data[i]
                    $items.push(makeArticleItem(item))
                }
                $('.result-list').append($items)
            }else if (type == 'Video') {
                for (var i = 0; i < data.length; i++) {
                    var item = data[i]
                    $items.push(makeVideoItem(item))
                }
                $('.videoWrap>ul').append($items)
            }else if (type == 'Member') {
                for (var i = 0; i < data.length; i++) {
                    var item = data[i]
                    $items.push(makeMemberItem(item))
                }
                $('.result-list').append($items)
            }
        }

        function xxxmakeArticleItem(dt) {
            var $item = $('.articleItemTmpl').clone().removeClass('articleItemTmpl').css('display', 'block')
            $item.find('.articleTitle').text(dt.Title)
            $item.find('.articleTitle').attr('href','news_detail.html?articleId='+dt.ArticleId)
            $item.find('.newsitem-img').attr('href','news_detail.html?articleId='+dt.ArticleId)
            $item.find('.articleDate').text(fmtDate1(dt.Timestamp))
            $item.find('.articleTags').text(dt.Keywords)
            $item.find('.articleAuthor').text(dt.Member.Name)
            $item.find('.articleImg').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.ImageKey)
            $item.find('.avatarKey').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.Member.AvatarKey)
            return $item
        }

        function makeVideoItem(dt) {
            var $item = $('.videoItemTmpl').clone().removeClass('articleItemTmpl').css('display', 'block');
            $item.find('.video-title').text(dt.Title);    //video title
            $item.find('.namemember').text(dt.Member.Name);  //namemember
            $item.find('.datamember').text(fmtDate1(dt.Timestamp));   //date
            $item.find('.icon-person').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.Member.AvatarKey);   //小头像
            $item.find('.newsvedio').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.ImageKey)   // 视频地址
            $item.find('.wrap-video-introduction').attr('href', "person_video_detail.html?VideoId="+dt.VideoId);
            return $item
        }

        function xmakeMemberItem(dt) {
            var $item = $('.memberItemTmpl').clone().removeClass('itemTmpl').css('display', 'block')
            var tagsStr = ''
            if(dt.tags && dt.tags.length){
                for(var i=0; i<dt.tags.length; i++){
                    tagsStr += dt.tags[i][EnglishName]
                    tagsStr += ' '
                }
            }
            $item.find('.memberTags').text(tagsStr)
//            $item.find('.memberCompany').text(dt.PersonalCompanyName)
//            $item.find('.articleDate').text(fmtDate1(dt.Timestamp))
//            $item.find('.articleTags').text(dt.Keywords)
            $item.find('.memberName').text(dt.Name)
            $item.find('.memberName').text(dt.Name)
            $item.find('.avatarImg').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.AvatarKey+'@!w170h170');
            $item.find('.person-item').attr('href','member_article.html?MemberId='+dt.MemberId)
            return $item
        }


        //
        $(".dropdown-menu li").children().first().click()
    })
</script>



<!-- -->

<style>
    a.tagbtn{
        display: inline-block;
        text-align: center;
        margin-right: 0.22rem;
        font-size: 0.26rem;
    }
    .tagBtn0{
        width: 1.3rem;
    }
    .tagBtn1{
        width: 1.6rem;
    }
    .tagBtn2{
        width: 2.06rem;
    }
    .tagBtn3{
        width: 1.46rem;
    }
    a:hover, a:visited, a:link, a:active {
        text-decoration: none;
        color: #3c3c3c;
    }
    .eventItemTmpl, .articleItemTmpl, .memberItemTmpl , .videoItemTmpl{
        display: none;
    }
    .row0{
        overflow: hidden;
    }
    .fl{
        float: left;
    }
    .fr{
        float: right;
    }
    .center-img-wrap{
        position: relative;
        overflow: hidden;
    }
    .center-img-wrap>img{
        position: absolute;
        width: 100%;
        top: 50%;
        left: 50%;
        transform: translate(-50%,-50%);
    }
    /** article **/
    .articleItem{
        padding: 0.30rem 0.22rem 0.30rem 0.22rem;
        margin-bottom: 0.09rem;
        background-color: #fff;

    }
    .articleImgWrap{
        width: 2.7rem;
        height: 1.66rem;
    }
    .articleTextWrap{
        position: relative;
        width: 4rem;
        height: 1.66rem;
    }
    .articleTitle{
        font-size: 0.26rem;
        max-height: 0.72rem;
        overflow: hidden;
        margin-bottom: 0.15rem;
    }
    .articleTags{
        max-height: 0.32rem;
        font-size: 0.22rem;
        color: #118ff6;
        margin-bottom: 0.15rem;
        white-space:nowrap;
    }
    .articleInfo{
        position: absolute;
        bottom: 0;
        overflow: hidden;
        width: 100%;
        height: 0.54rem;
    }
    .articleAuthorIcon{
        position: absolute;
        left: 0;
        bottom: 0;
        width: 0.43rem;
        height: 0.43rem;
        border-radius: 50%;
    }
    .articleAuthorIcon>img{
        width: 100%;
        height: 100%;

    }
    .articleAuthor{
        position: absolute;
        left: 0.58rem;
        top: 0.20rem;
        font-size: 0.21rem;
        color: #909090;
    }
    .articleDate{
        position: absolute;
        right: 0;
        top: 0.20rem;
        font-size: 0.19rem;
        color: #909090;
    }
    /** end article **/

    /** member **/


</style>

<div class="eventItem eventItemTmpl">
    <div>
        <div class="eventImgWrap">
            <img src="" alt="">
        </div>
        <div class="eventTextWrap">
            <div class="eventTitle"></div>
            <div class="eventSubTitle"></div>
            <div class="eventDate"></div>
        </div>
    </div>
</div>

<script>
    function makeArticleItem(dt) {
        var $item = $('.articleItemTmpl').clone().removeClass('articleItemTmpl')
        $item.find('.articleTitle').text(dt.Title)
        $item.find('.articleLink').attr('href','news_detail.html?articleId='+dt.ArticleId)
        $item.find('.articleDate').text(fmtDate1(dt.Timestamp))
        $item.find('.articleTags').text(dt.Keywords)
        $item.find('.articleAuthor').text(dt.Member.Name)
        $item.find('.articleImgWrap>img').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.ImageKey)
        $item.find('.articleAuthorIcon>img').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.Member.AvatarKey)
        return $item
    }
</script>
<div class="articleItem articleItemTmpl">
    <a href="" class="articleLink">
        <div class="row0">
            <div class="articleImgWrap center-img-wrap fl">
                <img src="" alt="">
            </div>
            <div class="articleTextWrap fr">
                <div class="articleTitle"></div>
                <div class="articleTags"></div>
                <div class="articleInfo">
                    <div class="articleAuthorIcon">
                        <img src="" alt="">
                    </div>
                    <div class="articleAuthor"></div>
                    <div class="articleDate"></div>
                </div>
            </div>
        </div>
    </a>
</div>



<style>

    .memberItem{
        width: 3.43rem;
        height: 1.7rem;
        position: relative;
        float: left;
        margin: 0.30rem 0 0.30rem 0.21rem;
    }
    .memberImgWrap{
        width: 50%;
        height: 1.7rem;
        position: relative;
        overflow: hidden;

    }
    .memberImgWrap>img{
        width: 100%;
        position: absolute;
        top: 50%;
        left:50%;
        transform: translate(-50%,-50%);
    }
    .memberTextWrap{
        width: 50%;
        height: 1.7rem;
        background: #f6f6f6;
        overflow: hidden;
        position: relative;
    }
    .memberName{
        position: absolute;
        top: 0.49rem;
        left: 0.26rem;
        font-size: 0.28rem;
        color: #646464;
    }
    .memberTags{
        position: absolute;
        top: 0.95rem;
        left: 0.26rem;
        font-size: 0.24rem;
        color: #118ff6;
        overflow: hidden;
        white-space: nowrap;
    }
</style>
<script>
    function makeMemberItem(dt) {
        var $item = $('.memberItemTmpl').clone().removeClass('memberItemTmpl')
        var tagsStr = ''
        if(dt.tags && dt.tags.length){
            for(var i=0; i<dt.tags.length; i++){
                tagsStr += dt.tags[i][EnglishName]
                tagsStr += ' '
            }
        }
        $item.find('.memberTags').text(tagsStr)
        $item.find('.memberName').text(dt.Name)
        $item.find('.memberImgWrap>img').attr('src','http://aaeca.img-us-west-1.aliyuncs.com/'+dt.AvatarKey+'@!w170h170');
        $item.find('.memberLink').attr('href','member_article.html?MemberId='+dt.MemberId)
        return $item
    }
</script>
<div class="memberItem memberItemTmpl">
    <a href="" class="memberLink">
        <div class="row0">
            <div class="memberImgWrap fl">
                <img src="" alt="">
            </div>
            <div class="memberTextWrap fl">
                <div class="memberName"></div>
                <div class="memberTags"></div>
            </div>
        </div>
    </a>
</div>


<div class="videoItem videoItemTmpl">
    <div>
        <div class="videoImgWrap">
            <img src="" alt="" class="videoImg" >
            <img src="" alt="" class="videoPlayIcon">
        </div>
        <div class="videoInfo">
            <div class="videoAuthorIcon"></div>
            <div class="videoAuthorName"></div>
            <div class="videoPostDate"></div>
        </div>
    </div>
</div>




</body>
</html>